{% extends "admin-base.html" %}
{% load static %}

{% block js %} {{block.super}}
<script type="text/javascript" src="{% static 'js/courses/app.js' %}"></script>
<script type="text/javascript" src="{% static 'js/courses/filters.js' %}"></script>
<script type="text/javascript" src="{% static 'js/courses/controllers.js' %}"></script>
<script type="text/javascript" src="{% static 'js/factories/timtec-models.js' %}"></script>
{% endblock %}

{% block content %}
<!-- COURSES -->
<section id="courses" class="container" ng-app="courses" ng-controller="CourseListController">
    <!--  HEADER -->
    <header>
        <div class="row">
            <div class="col-lg-6">
                <h1>Cursos</h1>
            </div>
            <div class="col-lg-6 textright">
                <a href="/admin/courses/new" class="btn btn-lg btn-success uppercase">Novo Curso</a>
            </div>
        </div>
    </header>
    <!-- END HEADER -->

    <!-- FILTERS -->
    <div class="filters">
        <!--  FORM INLINE -->
        <div class="form-inline">
            <!-- ROW -->
            <div class="row">
                <!-- COL-LG-6 -->
                <div class="col-lg-5">
                    <div class="checkbox">
                        <label><input ng-model="filters.all" type="checkbox"> Todos</label>
                        <label><input ng-model="filters.published" type="checkbox"> Publicado</label>
                        <label><input ng-model="filters.listed" type="checkbox"> Listado</label>
                        <label><input ng-model="filters.draft" type="checkbox"> Rascunho</label>
                    </div>
                </div>
                <!-- END COL-LG-6 -->
                <!-- COL-LG-3 -->
                <div class="col-lg-3 textright">
                    <input type="text" ng-model="filters.textsearch" placeholder="Palavra-chave" class="form-control"/>
                </div>
                <!-- END COL-LG-3 -->
                <!-- COL-LG-3 -->
                <div class="col-lg-3 textright">
                    <select ng-model="ordering" class="form-control">
                        <option value="id">Ordernar ...</option>
                        <option value="status">Status</option>
                        <option value="publication">Data de publicação</option>
                        <option value="name">Nome do curso</option>
                    </select>
                </div>
                <!-- END COL-LG-3 -->
                <div class="col-lg-1 textcenter">
                    <button class="btn btn-info" ng-class="{active:reverse}" ng-click="reverse=!reverse">Inverter</button>
                </div>
            </div>
            <!-- END ROW -->
        </div>
        <!-- END FORM INLINE -->
    </div>
    <!-- END FILTERS -->

    <!-- ALL COURSES -->
    <section id="all-courses" class="courses-list">

        {% verbatim %}
        <!-- COURSE -->
        <div class="course clearfix" ng-repeat="course in (filteredList = (courseList | orderBy:ordering:reverse | filter:filters.check))">
            <div class="col-lg-12">
                <h1><a href="/admin/courses/{{ course.id }}" title="{{ course.name }}">{{ course.name }}</a></h1>
                <div class="row">
                    <div class="col-lg-6">
                        <p>
                            <span class="label" ng-class="{
                                'label-default' : !(course.isDraft() || course.isListed() || course.isPublished()),
                                'label-warning': course.isDraft(),
                                'label-info': course.isListed(),
                                'label-success': course.isPublished()}">{{ course.status | capfirst }}</span>

                            <span class="label label-default pointer" ng-click="loadLessons(course);showLessons=!showLessons">Ver Lições <i class="fa" ng-class="{'fa fa-caret-down':!showLessons,'fa fa-caret-up':showLessons}"></i></span>
                        </p>
                    </div>
                    <div class="col-lg-6 textright">
                        <p>
                            <span ng-show="course.isPublished()">
                                <span class="date-label">Publicado em</span> <span class="date label label-success">{{ course.publication | date:'MMM, yyyy' }}</span>
                            </span>
                            <span ng-show="course.publication && !course.isPublished()">
                                <span class="date-label">Publicar em</span> <span class="date label label-info">{{ course.publication | date:'MMM, yyyy' }}</span>
                            </span>
                            <span ng-show="!course.publication">
                                <span class="date label label-danger">Sem data de publicação</span>
                            </span>
                        </p>
                    </div>
                </div>
                
                <div class="row" ng-show="showLessons">
                    <div class="col-lg-12" ng-hide="course.lessons.$resolved">
                        <span>Carrengando lista de lições...</span>
                    </div>
                    <div class="col-lg-12" ng-show="course.lessons.length == 0">
                        <span>Não há lições neste curso</span>
                    </div>
                    <div class="col-lg-12" ng-show="course.lessons">
                        <div class="lessons">
                            <div class="lesson" ng-repeat="lesson in course.lessons">
                                <div class="row">
                                    <div class="col-lg-1">
                                        <span class="label label-success" ng-bind="lesson.status">publicado</span>
                                    </div>
                                    <div class="col-lg-9">
                                        <h1><a href="" ng-bind="lesson.name">1 - Introdução: Internet e Web</a></h1>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
        <!-- END COURSE -->

        <div class="row" ng-show="filteredList.length === 0">
            <p class="textcenter">Nenhum curso encontrado</p>
        </div>
        {% endverbatim %}
    </section>
    <!-- END ALL-COURSES -->

</section>
<!-- END COURSES -->


{% endblock %}
